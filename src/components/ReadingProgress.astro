<div id="reading-progress" class="pointer-events-none fixed inset-x-0 top-0 z-40 h-0.5 origin-left scale-x-0 bg-[var(--accent)] transition-transform" aria-hidden="true"></div>

<script>
  const bar = document.getElementById("reading-progress");

  const update = () => {
    if (!bar) return;
    const article = document.querySelector("[data-reading-root]");
    if (!article) return;
    const rect = article.getBoundingClientRect();
    const total = Math.max(1, rect.height - window.innerHeight * 0.5);
    const progressed = Math.min(Math.max(0, -rect.top + 80), total);
    bar.style.transform = `scaleX(${progressed / total})`;
  };

  update();
  window.addEventListener("scroll", update, { passive: true });
  window.addEventListener("resize", update);
</script>
