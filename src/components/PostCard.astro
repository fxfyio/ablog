---
import type { PostEntry } from "@/lib/posts";
import { formatDate } from "@/lib/date";
import { getPostSummary, postPermalink } from "@/lib/posts";
import TagPill from "./TagPill.astro";

interface Props {
  post: PostEntry;
}

const { post } = Astro.props as Props;
---

<article class="surface subtle-grid p-5 md:p-6">
  <div class="mb-3 flex flex-wrap items-center gap-2 text-xs text-[var(--muted)]">
    <time datetime={post.data.date.toISOString()}>{formatDate(post.data.date)}</time>
    {post.data.updated && <span>更新于 {formatDate(post.data.updated)}</span>}
    <span class="rounded-full bg-[var(--accent-soft)] px-2 py-0.5 text-[var(--accent)]">文章</span>
  </div>

  <h2 class="text-xl font-semibold leading-snug text-[var(--accent)] md:text-2xl">
    <a class="hover:underline" href={postPermalink(post)}>
      {post.data.title}
    </a>
  </h2>

  <p class="mt-3 text-sm leading-7 text-[var(--muted)] md:text-base">{getPostSummary(post)}</p>

  {post.data.tags.length > 0 && (
    <ul class="mt-4 flex flex-wrap gap-2">
      {post.data.tags.slice(0, 4).map((tag) => (
        <li>
          <TagPill label={tag} href={`/tags/${encodeURIComponent(tag)}/`} />
        </li>
      ))}
    </ul>
  )}
</article>
